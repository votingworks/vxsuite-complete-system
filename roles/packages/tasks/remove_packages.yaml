---

- name: Remove packages
  package:
    name: "{{ item }}"
    state: absent
  with_items:
    - "{{ removed_packages }}"

- name: Purge packages
  apt:
    name: "{{ item }}"
    state: absent
    purge: true
  with_items:
    - "{{ purged_packages }}"

- name: Run autoremove if requested
  apt:
    autoremove: true
  when: remove_unused_packages is defined and remove_unused_packages|bool
    
